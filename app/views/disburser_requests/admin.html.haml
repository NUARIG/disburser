- content_for(:title) do
  Requests Admin

#disburser_requests
  .disburser_requests_header
    %h2
      Requests Admin
    = form_tag disburser_requests_url, method: 'get', id: 'search_disburser_requests_form'  do
      .search_box
        = text_field_tag :search, (params[:search].nil? ? '' : params[:search]), type: 'search'
      .search_buttons
        %button{ type: 'submit', id: 'search_disburser_requests_button', class: 'tiny button' }
          Search
        = link_to 'Clear', disburser_requests_url
  .disburser_requests_list
    = will_paginate @disburser_requests, renderer: FoundationPagination::Rails
    %table
      %thead
        %tr
          %th.title{ width: 200 }
            = sortable 'title'
          %th.submitter{ width: 200 }
            = sortable 'users.last_name', 'Submitter'
          %th.investigator{ width: 200 }
            = sortable 'investigator'
          %th.irb_number{ width: 200 }
            = sortable 'irb_number', 'IRB Number'
          %th.specimens{ width: 200 }
            = sortable 'specimens'
          %th.status{ width: 200 }
            = sortable 'status'
          %th.edit{ width: 100 }
      %tbody
        - @disburser_requests.each do |disburser_request|
          = content_tag_for(:tr, disburser_request) do
            %td.title
              = disburser_request.title
            %td.submitter
              = disburser_request.submitter.full_name
            %td.investigator
              = disburser_request.investigator
            %td.irb_number
              = disburser_request.irb_number
            %td.specimens
              = disburser_request.specimens
            %td.status
              = disburser_request.status
            %td.edit
              = link_to 'Edit', edit_repository_disburser_request_url(disburser_request.repository,  disburser_request), { class: 'edit_repository_link' }
    = will_paginate @disburser_requests, renderer: FoundationPagination::Rails
  .row
    %div{class: 'small-6 large-2 columns' }
      %b
        Repository
    %div{class: 'small-10 large-10 columns' }
      = select_tag :repository_id, options_for_select(Repository.order('name ASC').map { |repository| [repository.name, repository.id, { 'new_repository_request_url'=> new_repository_disburser_request_url(repository) }]}), { include_blank: 'Select a repository', class: 'repository_id'}
    %div{class: 'small-8 large-12 columns' }
      %span{ id: 'new_repository_request_link_label' }
        %b
          Make a request!
      = link_to 'Make a request!', new_repository_disburser_request_url(repository_id: ':repository_id'), { id: 'new_repository_request_link', class: 'hide' }
